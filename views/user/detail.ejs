<%- include('../includes/head.ejs') %>
    <link rel="stylesheet" href="/css/card.css">
    </head>

    <body>
        <%- include('../includes/navigation.ejs') %>
            <main class="centered">
                <div class=" row col-12 col-md-10" style="margin: auto;">
                    <blockquote class="blockquote text-center mt-3">
                        <p class="mb-0" style="font-size: 1.8rem;
                        line-height: 2.5rem; font-weight: 500; font-family: Nunito,Arial,sans-serif; color:#a50064">
                            <%= project.title %>
                        </p>
                        <footer class="blockquote-footer">Có điều kỳ diệu xảy đến với những người thực sự biết yêu
                            thương: họ càng cho nhiều, họ càng có nhiều. <cite title="Source Title">– Rainer Maria
                                Rilke</cite></footer>
                    </blockquote>
                    <hr>
                    <div class="col-12 col-md-8">
                        <div>

                            <div class="image">
                                <img src="/<%= project.imageUrl %>" alt="<%= project.title %>" style="width:100%">
                            </div>
                            <div class="mt-3">
                                <%-project.description %>
                            </div>
                            <hr>
                        </div>

                    </div>
                    <div class="col-12 col-md-4">
                        <div class="card mt-3" style="width: 20rem; border-radius: 0.5rem; max-width: 100%;">
                            <img class="card-img-top" style="border-radius: 0.5rem;" src="/<%= project.imageUrl %>"
                                alt="Card image cap">
                            <div class="card-body">
                                <p><span style="color:rgb(64, 64, 64); font-weight: bolder;">
                                        <%= project.totalAmountRaised.toLocaleString('vi', {style : 'currency' ,
                                            currency : 'VND' })%>
                                    </span><span style="color:rgb(115, 115, 115);">/
                                        <%= project.target.toLocaleString('vi', {style : 'currency' , currency : 'VND'
                                            })%>
                                    </span></p>
                                <div class="m-1"
                                    style="width:100%; height: 0.2rem; background-color: #b2bdc6d5; border-radius:0.2em;">
                                    <div
                                        style=" max-width:100%; width:<%= (project.totalAmountRaised/project.target*100).toString() %>%; height: 0.2rem; background-color: #a50064;; border-radius:0.2em;">
                                    </div>
                                </div>
                                <div class="row m-1">
                                    <div style="width: 35%">
                                        <p style="font-size: 0.8rem; color: #b2bdc6d5; margin-bottom:0rem;">Lượt
                                            quyên góp</p>
                                        <p style="color: rgba(82,82,82,1) ;">
                                            <%=new Intl.NumberFormat().format(project.luotQuyengop) %>
                                        </p>
                                    </div>
                                    <div style="width: 30%; text-align: center;">
                                        <p style="font-size: 0.8rem; color: #b2bdc6d5; margin-bottom:0rem;">Đạt
                                            được</p>
                                        <p style="color: rgba(82,82,82,1);">
                                            <%= new
                                                Intl.NumberFormat().format((project.totalAmountRaised/project.target*100))%>
                                                %
                                        </p>
                                    </div>
                                </div>
                                <form action="/quyengop" method="POST" novalidate>
                                    <div class="form-group">
                                        <label for="contributionAmount">Số tiền</label>
                                        <input type="number" name="contributionAmount" id="contributionAmount"
                                            class="<%= validationErrors.find(e => e.param === 'contributionAmount') ? ' form-control invalid' : 'form-control' %>"
                                            placeholder="<%=(1000000).toLocaleString('vi', {style : 'currency' , currency : 'VND' }) %>"
                                            value=""
                                            style="color:#a50064; border-color: #a50064; border-radius:0.2em;">
                                    </div>
                                    <div class="form-group">
                                        <label for="message"> Lời nhắn gửi</label>
                                        <input type="text" name="message" id="message"
                                            class="<%= validationErrors.find(e => e.param === 'Message') ? ' form-control invalid' : 'form-control' %>"
                                            style="border-radius:0.2em;" value="" placeholder=" Bình an nhé!">
                                    </div>

                                    <div class="form-check">
                                        <input class="form-check-input selectElement" type="checkbox" value=""
                                            id="check_hine" /> Quyên góp ẩn danh
                                    </div>
                                    <input type="hidden" name="projId" value="<%= project._id %>">
                                    <%if(user){%>
                                        <input type="hidden" name="userId" value="<%= user._id %>">
                                        <%}%>
                                            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                                            <button type="submit" class="btn btn-primary btn-block"
                                                style="color: #f8f9fa; background-color: #a50064; border-color: #a50064;border-radius:0.2em;">
                                                Quyên góp</button>
                                </form>

                            </div>
                            <div class="card-footer">
                                <%if(project.startDate > new Date()){%>
                                <small class="text-muted">coming soon</small>
                                <%}else if (project.totalAmountRaised>= project.target){%>
                                    <small class="text-muted">Đạt mục tiêu</small>
                                <%} else if(project.startDate <= new Date()){%>
                                    <small class="text-muted" style="background-color:#ffe8df;border-radius:3rem; color: #fb923c !important; padding:0.1rem;"> còn <%= Math.floor((project.endDate.valueOf() - new Date().valueOf())/86400000)%> ngày</small>
                                    <%}else {%>
                                        <small class="text-muted">finished</small>
                                        <%}%>
                            </div>
                        </div>

                    </div>


                </div>


            </main>
            <%- include('../includes/end.ejs') %>