<%- include('../includes/head.ejs') %>
    <link rel="stylesheet" href="/css/forms.css">
    <link rel="stylesheet" href="/css/product.css">
    <script src="/ckeditor/ckeditor.js"></script>

    </head>

    <body>
        <%- include('../includes/navigation.ejs') %>

            <main class="mt-3">

                <% if (errorMessage) { %>
                    <div class="alert alert-danger">
                        <%= errorMessage %>
                    </div>
                    <% } %>
                        <div style="max-width: 99%; margin: auto; width: 90%; ">
                            <form action="/admin/<% if (editing) { %>edit-project<% } else { %>add-project<% } %>"
                                method="POST" enctype="multipart/form-data">
                                <div class="form-group col-12">
                                    <label for="title">Tiêu đề</label>
                                    <input
                                        class=" form-control <%= validationErrors.find(e => e.param === 'title') ? 'invalid' : '' %>"
                                        type="text" name="title" id="title"
                                        value="<% if (editing || hasError) { %><%= project.title %><% } %>">
                                </div>

                                <div class="form-group">
                                    <label for="img">Ảnh đại diện <svg xmlns="http://www.w3.org/2000/svg" width="16"
                                            height="16" fill="currentColor" class="bi bi-upload" viewBox="0 0 16 16">
                                            <path
                                                d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z" />
                                            <path
                                                d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z" />
                                        </svg></label>
                                    <input type="file" name="upload" id="img" class="form-control-file">
                                </div>
                                <div class="row">
                                    <div class="form-group col-12 col-md-4">
                                        <label for="startDate">Ngày bắt đầu</label>
                                        <input
                                            class="form-control <%= validationErrors.find(e => e.param === 'startDate') ? 'invalid' : '' %>"
                                            type="date" name="startDate" id="startDate"
                                            value="<% if ((editing)&& project.startDate!=='') { %><%= project.startDate.toISOString().slice(0, 10) %><% } if(hasError) {%><%=project.startDate%><%}%>">
                                    </div>
                                    <div class="form-group col-12 col-md-4" style="margin:auto;">
                                        <label for="endDate">Ngày kết thúc</label>
                                        <input
                                            class="form-control <%= validationErrors.find(e => e.param === 'endDate') ? 'invalid' : '' %>"
                                            type="date" name="endDate" id="endDate"
                                            value="<% if ((editing)&& project.startDate!=='') { %><%= project.endDate.toISOString().slice(0, 10) %><% } if(hasError) {%><%=project.endDate%><%}%>">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-12 col-md-4">
                                        <label for="target">Mục tiêu</label> 
                                        <input
                                            class="form-control <%= validationErrors.find(e => e.param === 'target') ? 'invalid' : '' %>"
                                            type="number" name="target" id="target" step="1000"
                                            value="<% if (editing || hasError) { %><%= project.target %><% }%>">
                                            <small  class="form-text text-muted" id ='targetString'></small>
                                    </div>
                                    <div class="form-group col-12 col-md-4" style="margin:auto;">
                                        <label for="status">Trạng thái</label>
                                        <select class="form-control" name="status" id="status">
                                            <option value="waiting" <%if(editing && project.status=='waiting' ){ %>
                                                selected
                                                <%}%>>waiting
                                            </option>
                                            <option value="runing" <%if(editing && project.status=='runing' ){ %>
                                                selected
                                                <%}%>>runing
                                            </option>
                                            <option value="stop" <%if(editing && project.status=='stop' ){ %> selected
                                                <%}%>
                                                    >stop</option>
                                        </select>
                                    </div>

                                </div>
                                <div class="form-group">
                                    <label for="description">Mô tả chi tiết</label>
                                    <textarea
                                        class=" form-control <%= validationErrors.find(e => e.param === 'description') ? 'invalid' : '' %>"
                                        name="description" id="txaContent"
                                        rows="5"><% if (editing || hasError) { %><%= project.description %><% } %></textarea>
                                </div>

                                <% if (editing) { %>
                                    <input type="hidden" value="<%= project._id %>" name="projectId">
                                    <% } %>

                                        <input type="hidden" name="_csrf" id="_csrf" value="<%= csrfToken %>">
                                        <div class= "col-3" style="margin:auto;">
                                            <button type="submit" class="btn btn-primary mb-2" style="width:100%">
                                                <% if (editing) { %>Update Project<% } else { %>Add Project<% } %>
                                            </button>
                                        </div>
                            </form>
                        </div>
            </main>
            <script src="/js/admin-editor.js"></script>
            <%- include('../includes/end.ejs') %>