<%- include('../includes/head.ejs') %>
    <link rel="stylesheet" href="/css/forms.css">
    <link rel="stylesheet" href="/css/product.css">
    <script src="/ckeditor/ckeditor.js"></script>

    </head>

    <body>
        <%- include('../includes/navigation.ejs') %>

            <main class="mt-3">
                
                <% if (errorMessage) { %>
                    <div class="alert alert-danger">
                        <%= errorMessage %>
                    </div>
                    <% } %>
                        <div style="max-width:500px; margin: auto ">
                            <form action="/admin/<% if (editing) { %>edit-project<% } else { %>add-project<% } %>"
                                method="POST" enctype="multipart/form-data">
                                <div class="form-group">
                                    <label for="title">Title</label>
                                    <input
                                        class=" form-control <%= validationErrors.find(e => e.param === 'title') ? 'invalid' : '' %>"
                                        type="text" name="title" id="title"
                                        value="<% if (editing || hasError) { %><%= project.title %><% } %>">
                                </div>
                          
                                <div class="form-group">
                                    <label for="image">Image</label>
                                    <input type="file" name="upload" id="image" class="form-control-file">
                                </div>
                                <div class="form-group">
                                    <label for="startDate">Ngày bắt đầu</label>
                                    <input
                                        class="form-control <%= validationErrors.find(e => e.param === 'startDate') ? 'invalid' : '' %>"
                                        type="date" name="startDate" id="startDate"
                                        value="<% if ((editing || hasError)&& project.startDate!=='') { %><%= project.startDate.toISOString().slice(0, 10) %><% } %>">
                                </div>
                                <div class="form-group">
                                    <label for="endDate">Ngày kết thúc</label>
                                    <input
                                        class="form-control <%= validationErrors.find(e => e.param === 'endDate') ? 'invalid' : '' %>"
                                        type="date" name="endDate" id="endDate"
                                        value="<% if ((editing || hasError )&& project.endDate !=='') { %><%= project.endDate.toISOString().slice(0, 10) %><% } %>">
                                </div>
                                <div class="form-group">
                                    <label for="target">Mục tiêu</label>
                                    <input
                                        class="form-control <%= validationErrors.find(e => e.param === 'target') ? 'invalid' : '' %>"
                                        type="number" name="target" id="target" step="1000"
                                        value="<% if (editing || hasError) { %><%= project.target %><% }%>">
                                </div>
                                <div class="form-group">
                                    <label for="description">Description</label>
                                    <textarea
                                        class=" form-control <%= validationErrors.find(e => e.param === 'description') ? 'invalid' : '' %>"
                                        name="description" id="txaContent"
                                        rows="5"><% if (editing || hasError) { %><%= project.description %><% } %></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="status">Trạng thái</label>
                                    <select class="form-control" name="status" id="status">
                                        <option value="waiting" <%if(editing && project.status=='waiting' ){ %> selected
                                            <%}%>>waiting</option>
                                        <option value="runing" <%if(editing && project.status=='runing' ){ %> selected
                                            <%}%>>runing</option>
                                        <option value="stop" <%if(editing && project.status=='stop' ){ %> selected<%}%>
                                                >stop</option>
                                    </select>
                                </div>
                                <% if (editing) { %>
                                    <input type="hidden" value="<%= project._id %>" name="projectId">
                                    <% } %>

                                        <input type="hidden" name="_csrf" id="_csrf" value="<%= csrfToken %>">
                                        <button type="submit" class="btn btn-primary mb-2">
                                            <% if (editing) { %>Update Project<% } else { %>Add Project<% } %>
                                        </button>
                            </form>
                        </div>
            </main>
            <script src="/js/admin-editor.js"></script>
            <%- include('../includes/end.ejs') %>